"use strict";(self.webpackChunkatlas_site=self.webpackChunkatlas_site||[]).push([[8161],{1904:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>t,contentTitle:()=>o,default:()=>p,frontMatter:()=>r,metadata:()=>a,toc:()=>c});const a=JSON.parse('{"id":"metodos/metodos_charts_and_styles","title":"Charts & estilos \u2014 tablas, escalas y diagramas","description":"y decisiones","source":"@site/docs/metodos/charts_and_styles.md","sourceDirName":"metodos","slug":"/metodos/charts_and_styles","permalink":"/atlas-site/docs/metodos/charts_and_styles","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"charts","permalink":"/atlas-site/docs/tags/charts"},{"inline":true,"label":"estilos","permalink":"/atlas-site/docs/tags/estilos"},{"inline":true,"label":"mapbox","permalink":"/atlas-site/docs/tags/mapbox"},{"inline":true,"label":"color","permalink":"/atlas-site/docs/tags/color"},{"inline":true,"label":"graphviz","permalink":"/atlas-site/docs/tags/graphviz"}],"version":"current","frontMatter":{"id":"metodos_charts_and_styles","title":"Charts & estilos \u2014 tablas, escalas y diagramas","slug":"/metodos/charts_and_styles","module":"metodos","version":"0.1.0","status":"draft","owners":["atlas-core"],"tags":["charts","estilos","mapbox","color","graphviz"],"source_repo":"https://github.com/matuteiglesias/atlas-site","source_path":"docs/metodos/charts_and_styles.md"},"sidebar":"tutorialSidebar","previous":{"title":"M\xe9todos","permalink":"/atlas-site/docs/category/m\xe9todos"},"next":{"title":"Pol\xedticas de JSON y export (estructura, compresi\xf3n, timestamps, merges)","permalink":"/atlas-site/docs/metodos/etl_json_policies"}}');var i=n(4848),l=n(8453);const r={id:"metodos_charts_and_styles",title:"Charts & estilos \u2014 tablas, escalas y diagramas",slug:"/metodos/charts_and_styles",module:"metodos",version:"0.1.0",status:"draft",owners:["atlas-core"],tags:["charts","estilos","mapbox","color","graphviz"],source_repo:"https://github.com/matuteiglesias/atlas-site",source_path:"docs/metodos/charts_and_styles.md"},o=void 0,t={},c=[{value:"1) DataFrames estilizados (barras, notaci\xf3n)",id:"1-dataframes-estilizados-barras-notaci\xf3n",level:2},{value:"2) Mapas (Matplotlib) \u2014 overlay con transparencia",id:"2-mapas-matplotlib--overlay-con-transparencia",level:2},{value:"3) Mapbox \u2014 pol\xedticas de escalas y \u201cinterpolate\u201d",id:"3-mapbox--pol\xedticas-de-escalas-y-interpolate",level:2},{value:"4) Convenciones de diagramaci\xf3n (swimlanes, graphviz)",id:"4-convenciones-de-diagramaci\xf3n-swimlanes-graphviz",level:2},{value:"5) Accesibilidad, leyendas y estilos",id:"5-accesibilidad-leyendas-y-estilos",level:2},{value:"6) QA de visualizaciones (checklist)",id:"6-qa-de-visualizaciones-checklist",level:2},{value:"7) Deprecaciones",id:"7-deprecaciones",level:2}];function d(e){const s={code:"code",h2:"h2",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.p,{children:["y decisiones\nGu\xeda unificada para (a) ",(0,i.jsx)(s.strong,{children:"tablas estilizadas"})," en notebooks/reportes, (b) ",(0,i.jsx)(s.strong,{children:"escalas de color e interpolaci\xf3n"})," para Mapbox (fill-color), y (c) ",(0,i.jsx)(s.strong,{children:"convenciones de diagramaci\xf3n"})," para procesos y flujos de datos."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Decisiones (consolidadas)"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Un solo contrato de escalas por m\xe9trica"})," (rangos lineales predefinidos + ",(0,i.jsx)(s.code,{children:"linspace"}),") y ",(0,i.jsx)(s.strong,{children:"parcheo determinista"})," de ",(0,i.jsx)(s.code,{children:"interpolate_list"}),". Deprecamos \u201clistas ad-hoc\u201d de stops sin doc. "]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Presentaci\xf3n acoplada tabla+gr\xe1fico"})," (cuando corresponda), y ",(0,i.jsx)(s.strong,{children:"overlays"})," en mapas con transparencia controlada. "]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Diagramas con s\xedmbolos/colores consistentes"})," y uso preferente de ",(0,i.jsx)(s.strong,{children:"graphviz"})," para reproducibilidad. "]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"1-dataframes-estilizados-barras-notaci\xf3n",children:"1) DataFrames estilizados (barras, notaci\xf3n)"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Objetivo:"})," mejorar lectura r\xe1pida de tablas en notebooks y reportes impresos."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Patrones recomendados"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Barras horizontales"})," sobre columnas cuantitativas (percentiles o magnitudes)."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Formato"}),": si la magnitud lo requiere, notaci\xf3n ",(0,i.jsx)(s.strong,{children:"ingenieril"})," o ",(0,i.jsx)(s.strong,{children:"cient\xedfica"})," con sufijos (",(0,i.jsx)(s.code,{children:"K"}),", ",(0,i.jsx)(s.code,{children:"M"}),")."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Ordenaci\xf3n y subtotales"})," por ",(0,i.jsx)(s.code,{children:"grouper"})," antes del estilo (evita que el formateo oculte outliers)."]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Snippet (pandas Styler)"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"def style_table(df, cols_pct=None, cols_num=None):\n    s = df.copy()\n    if cols_pct:\n        s[cols_pct] = s[cols_pct].astype(float)\n    if cols_num:\n        s[cols_num] = s[cols_num].astype(float)\n    sty = s.style\n    if cols_pct:\n        sty = sty.bar(subset=cols_pct, color='#DDEBF7', align='zero')\n        sty = sty.format({c: '{:.1%}' for c in cols_pct})\n    if cols_num:\n        sty = sty.bar(subset=cols_num, color='#FCE4D6')\n        sty = sty.format({c: '{:,.0f}' for c in cols_num})\n    return sty.set_table_styles([{'selector': 'th', 'props': 'text-align:center;'}])\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Tabla y gr\xe1fico \u201cpegados\u201d en el output"}),": mostrar la tabla ",(0,i.jsx)(s.strong,{children:"justo debajo"})," del plot para cada ",(0,i.jsx)(s.code,{children:"distrito/secci\xf3n"})," mejora el contexto y reduce scroll. "]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"2-mapas-matplotlib--overlay-con-transparencia",children:"2) Mapas (Matplotlib) \u2014 overlay con transparencia"}),"\n",(0,i.jsxs)(s.p,{children:["Para inspecciones r\xe1pidas sin stack web: ",(0,i.jsx)(s.strong,{children:"dibujar geometr\xedas"})," y ",(0,i.jsx)(s.strong,{children:"superponer"})," un mosaico base con ",(0,i.jsx)(s.code,{children:"imshow"})," usando los ",(0,i.jsx)(s.strong,{children:"bounds"})," del ",(0,i.jsx)(s.code,{children:"Axes"}),", y aplicar ",(0,i.jsx)(s.strong,{children:"alpha"})," en la capa vectorial. "]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"fig, ax = plt.subplots(figsize=(10,6))\ncircuitos_gdf.dropna().plot(ax=ax, alpha=0.5)  # capa vectorial\nminx, maxx = ax.get_xlim(); miny, maxy = ax.get_ylim()\nimage = get_maps_image(minx, miny, maxx, maxy)  # recupera raster de fondo\nax.imshow(image, extent=[minx, maxx, miny, maxy], aspect='equal')\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Regla:"})," el mapa base ",(0,i.jsx)(s.strong,{children:"no"})," debe tapar la simbolog\xeda; controlarlo con ",(0,i.jsx)(s.code,{children:"alpha"})," en la capa vectorial. "]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"3-mapbox--pol\xedticas-de-escalas-y-interpolate",children:"3) Mapbox \u2014 pol\xedticas de escalas y \u201cinterpolate\u201d"}),"\n",(0,i.jsxs)(s.p,{children:["Estandarizamos ",(0,i.jsx)(s.strong,{children:"rangos lineales"})," por m\xe9trica y la ",(0,i.jsx)(s.strong,{children:"inserci\xf3n"})," de stops en ",(0,i.jsx)(s.code,{children:"interpolate_list"}),":"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Rangos sugeridos"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Pobreza"}),": 0 \u2192 0.60"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Indigencia"}),": 0 \u2192 0.25"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Canasta alimentaria (CBA)"}),": 0 \u2192 300 000"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Canasta total (CBT)"}),": 0 \u2192 600 000"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Ingreso mediano"}),": 0 \u2192 300 000"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Ingreso total familiar"}),": 0 \u2192 600 000\nEstos rangos vienen de la pr\xe1ctica en tus cuadernos y se implementan con ",(0,i.jsx)(s.code,{children:"np.linspace"})," para ",(0,i.jsx)(s.code,{children:"n_stops"})," uniforme. "]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Generaci\xf3n de stops"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"# ejemplo reducida\nif 'Pobreza' in title:\n    linspace_values = np.linspace(0, 0.6, n_stops)\nelif 'Indigencia' in title:\n    linspace_values = np.linspace(0, 0.25, n_stops)\nelif 'Canasta Alimentaria' in title:\n    linspace_values = np.linspace(0, 300000, n_stops)\n# ... (resto de m\xe9tricas)\n"})}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsxs)(s.strong,{children:["Inserci\xf3n/actualizaci\xf3n en ",(0,i.jsx)(s.code,{children:"interpolate_list"})]}),"\nLa estructura t\xedpica de ",(0,i.jsx)(s.code,{children:"fill-color"})," es:"]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{children:"['interpolate', ['linear'], ['get', VAR],\n  v1, '#hex1', v2, '#hex2', ...]\n"})}),"\n",(0,i.jsxs)(s.p,{children:["El reemplazo correcto es ",(0,i.jsx)(s.strong,{children:"antes de cada color hex"})," o sobrescribiendo cada valor num\xe9rico tras el ",(0,i.jsx)(s.code,{children:"['get', VAR]"}),". Evitar reemplazar colores o el ",(0,i.jsx)(s.code,{children:"get"}),". "]}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-python",children:"def update_values(interpolate_list, linspace_values):\n    is_next_val_scale, color_idx, i = False, 0, 0\n    while i < len(interpolate_list):\n        val = interpolate_list[i]\n        if isinstance(val, list) and val[0] == 'get':\n            is_next_val_scale = True\n        elif is_next_val_scale and isinstance(val, (int, float)):\n            interpolate_list[i] = linspace_values[color_idx]; color_idx += 1\n        elif is_next_val_scale and isinstance(val, str) and val.startswith(\"#\"):\n            is_next_val_scale = False\n        i += 1\n    return interpolate_list\n"})}),"\n",(0,i.jsxs)(s.p,{children:["Este patr\xf3n refleja la ",(0,i.jsxs)(s.strong,{children:["detecci\xf3n del ",(0,i.jsx)(s.code,{children:"get"})]})," y el ",(0,i.jsx)(s.strong,{children:"recorrido seguro"})," de stops, con variantes donde se ",(0,i.jsx)(s.strong,{children:"inserta"})," el valor num\xe9rico inmediatamente ",(0,i.jsx)(s.strong,{children:"antes"})," del color si la lista carece de stops expl\xedcitos. "]}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Depuraci\xf3n"}),": trazar con ",(0,i.jsx)(s.code,{children:"print"})," las decisiones (",(0,i.jsx)(s.code,{children:"Found 'get'"}),", ",(0,i.jsx)(s.code,{children:"Replacing value\u2026"}),") facilita validar que solo toc\xe1s los stops y no los colores. "]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"4-convenciones-de-diagramaci\xf3n-swimlanes-graphviz",children:"4) Convenciones de diagramaci\xf3n (swimlanes, graphviz)"}),"\n",(0,i.jsxs)(s.p,{children:[(0,i.jsx)(s.strong,{children:"Objetivo:"})," comunicar pipelines y responsabilidades con ",(0,i.jsx)(s.strong,{children:"claridad"})," y ",(0,i.jsx)(s.strong,{children:"consistencia"}),"."]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"S\xedmbolos"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Rect\xe1ngulos"})," = procesos/operaciones; ",(0,i.jsx)(s.strong,{children:"paralelogramo"})," = entrada/salida; ",(0,i.jsx)(s.strong,{children:"diamante"})," = decisi\xf3n; ",(0,i.jsx)(s.strong,{children:"\xf3valo"})," = inicio/fin; ",(0,i.jsx)(s.strong,{children:"flechas"})," = flujo. "]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Capas y swimlanes"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Swimlanes"})," (por equipo o etapa) y ",(0,i.jsx)(s.strong,{children:"layers"})," (por fase) mejoran la lectura en flujos complejos. "]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Herramientas"})}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Graphviz"})," (recomendado para versionar), o Visio/Lucid/draw.io para diagramas manuales; Airflow/Prefect si se genera desde orquestadores. "]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.strong,{children:"Snippet (DOT m\xednimo)"})}),"\n",(0,i.jsx)(s.pre,{children:(0,i.jsx)(s.code,{className:"language-dot",children:'digraph atlas_pipeline {\n  rankdir=LR; node [shape=rectangle, style=rounded];\n  subgraph cluster_ingesta { label="Ingesta"; n1[label="EPH"]; n2[label="Censo"]; }\n  subgraph cluster_etl { label="ETL"; e1[label="Preprocesar"]; e2[label="Merges"]; }\n  subgraph cluster_modelo { label="Modelo"; m1[label="Entrenar"]; m2[label="Publicar m\xe9tricas"]; }\n  n1 -> e1 -> e2 -> m1 -> m2;\n}\n'})}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"5-accesibilidad-leyendas-y-estilos",children:"5) Accesibilidad, leyendas y estilos"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Accesibilidad"}),": evitar pares rojo/verde sin textura; asegurar contraste AA."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Leyenda"}),": orden de bins consistente (menor\u2192mayor), y ",(0,i.jsx)(s.strong,{children:"texto corto"})," con umbrales expl\xedcitos."]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Texturas/Hatches"}),": usar \u201c///\u201d, \u201c//\u201d, \u201c/\u201d para densidad cualitativa en mapas mon\xf3cromos (fallback impresi\xf3n)."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"6-qa-de-visualizaciones-checklist",children:"6) QA de visualizaciones (checklist)"}),"\n",(0,i.jsxs)(s.ol,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Escala correcta"}),": rangos y ",(0,i.jsx)(s.code,{children:"n_stops"})," acordes a la m\xe9trica; validar ",(0,i.jsx)(s.code,{children:"fill-color"})," despu\xe9s del parcheo. "]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Overlay"}),": el mapa base no tapa la simbolog\xeda (ver ",(0,i.jsx)(s.code,{children:"alpha"}),"). "]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Tabla/plot acoplados"}),": tabla debajo del gr\xe1fico cuando se itera por ",(0,i.jsx)(s.code,{children:"distrito/secci\xf3n"}),". "]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Convenciones"}),": s\xedmbolos y colores respetan la gu\xeda (rect\xe1ngulo/proceso, diamante/decisi\xf3n). "]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Determinismo"}),": el mismo dataset produce los mismos stops (linspace) y la misma leyenda."]}),"\n"]}),"\n",(0,i.jsx)(s.hr,{}),"\n",(0,i.jsx)(s.h2,{id:"7-deprecaciones",children:"7) Deprecaciones"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Dejado de usar ",(0,i.jsx)(s.strong,{children:"paletas manuales dispersas"})," y ",(0,i.jsx)(s.strong,{children:"stops no documentados"}),"."]}),"\n",(0,i.jsxs)(s.li,{children:["Evitar scripts que mutan ",(0,i.jsx)(s.code,{children:"interpolate_list"})," sin detectar ",(0,i.jsx)(s.code,{children:"['get', VAR]"})," primero. "]}),"\n"]})]})}function p(e={}){const{wrapper:s}={...(0,l.R)(),...e.components};return s?(0,i.jsx)(s,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,s,n)=>{n.d(s,{R:()=>r,x:()=>o});var a=n(6540);const i={},l=a.createContext(i);function r(e){const s=a.useContext(l);return a.useMemo(function(){return"function"==typeof e?e(s):{...s,...e}},[s,e])}function o(e){let s;return s=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),a.createElement(l.Provider,{value:s},e.children)}}}]);