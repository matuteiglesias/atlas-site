"use strict";(self.webpackChunkatlas_site=self.webpackChunkatlas_site||[]).push([[7213],{8453:(e,o,r)=>{r.d(o,{R:()=>a,x:()=>c});var s=r(6540);const t={},n=s.createContext(t);function a(e){const o=s.useContext(n);return s.useMemo(function(){return"function"==typeof e?e(o):{...o,...e}},[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:a(e.components),s.createElement(n.Provider,{value:o},e.children)}},9041:(e,o,r)=>{r.r(o),r.d(o,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>s,toc:()=>i});const s=JSON.parse('{"id":"pocket/pocket_geo_plot_prechecks","title":"GeoPandas plot \u2014 pre-checks","description":"Prop\xf3sito","source":"@site/docs/pocket/geo_plot_prechecks.md","sourceDirName":"pocket","slug":"/pocket/geo_plot_prechecks","permalink":"/docs/pocket/geo_plot_prechecks","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/pocket/geo_plot_prechecks.md","tags":[{"inline":true,"label":"geopandas","permalink":"/docs/tags/geopandas"},{"inline":true,"label":"plotting","permalink":"/docs/tags/plotting"},{"inline":true,"label":"qa","permalink":"/docs/tags/qa"},{"inline":true,"label":"geometry","permalink":"/docs/tags/geometry"},{"inline":true,"label":"merges","permalink":"/docs/tags/merges"}],"version":"current","frontMatter":{"id":"pocket_geo_plot_prechecks","title":"GeoPandas plot \u2014 pre-checks","slug":"/pocket/geo_plot_prechecks","module":"apendice-pocket","version":"0.1.0","status":"draft","owners":["atlas-core"],"tags":["geopandas","plotting","qa","geometry","merges"],"source_repo":"<repo-url>","source_path":"docs/pocket/geo_plot_prechecks.md"},"sidebar":"tutorialSidebar","previous":{"title":"Scatter + box ponderado (overlay)","permalink":"/docs/pocket/geo_overlay_scatter_box"},"next":{"title":"Hatches en GeoPandas","permalink":"/docs/pocket/geopandas_hatches"}}');var t=r(4848),n=r(8453);const a={id:"pocket_geo_plot_prechecks",title:"GeoPandas plot \u2014 pre-checks",slug:"/pocket/geo_plot_prechecks",module:"apendice-pocket",version:"0.1.0",status:"draft",owners:["atlas-core"],tags:["geopandas","plotting","qa","geometry","merges"],source_repo:"<repo-url>",source_path:"docs/pocket/geo_plot_prechecks.md"},c=void 0,l={},i=[{value:"Prop\xf3sito",id:"prop\xf3sito",level:2},{value:"Checklist (m\xednimo)",id:"checklist-m\xednimo",level:2},{value:"Snippets",id:"snippets",level:2},{value:"1) NaNs y limpieza",id:"1-nans-y-limpieza",level:3},{value:"2) Activar columna geometry tras un merge",id:"2-activar-columna-geometry-tras-un-merge",level:3},{value:"3) CRS y smoke-plot",id:"3-crs-y-smoke-plot",level:3},{value:"4) Merge que pierde geometry (patr\xf3n seguro)",id:"4-merge-que-pierde-geometry-patr\xf3n-seguro",level:3},{value:"Pitfalls comunes",id:"pitfalls-comunes",level:2}];function d(e){const o={blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,n.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.h2,{id:"prop\xf3sito",children:"Prop\xf3sito"}),"\n",(0,t.jsxs)(o.p,{children:["Checklist r\xe1pido antes de plotear con ",(0,t.jsx)(o.strong,{children:"GeoPandas"}),": ",(0,t.jsx)(o.code,{children:"geometry"})," activa, NaNs, CRS y merges que degradan tipos."]}),"\n",(0,t.jsx)(o.h2,{id:"checklist-m\xednimo",children:"Checklist (m\xednimo)"}),"\n",(0,t.jsxs)(o.ol,{children:["\n",(0,t.jsx)(o.li,{children:(0,t.jsx)(o.strong,{children:"NaNs en geometry"})}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Columna geometry activa"})," (",(0,t.jsx)(o.code,{children:"set_geometry"}),")"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"CRS consistente"})," entre capas"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Merge que preserva geometry"})," (o reconstituir ",(0,t.jsx)(o.code,{children:"GeoDataFrame"}),")"]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Plot de humo"})," para descartar aspect ratio/coords inv\xe1lidas"]}),"\n"]}),"\n",(0,t.jsx)(o.h2,{id:"snippets",children:"Snippets"}),"\n",(0,t.jsx)(o.h3,{id:"1-nans-y-limpieza",children:"1) NaNs y limpieza"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:"# conteo de NaNs\nn_nan = gdf['geometry'].isna().sum()\nif n_nan:\n    print(f\"[warn] {n_nan} geometr\xedas NaN \u2192 se dropean para plot\")\n    gdf = gdf.dropna(subset=['geometry'])\n"})}),"\n",(0,t.jsx)(o.h3,{id:"2-activar-columna-geometry-tras-un-merge",children:"2) Activar columna geometry tras un merge"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:"# si tras el merge la geometry qued\xf3 como object, reactivarla:\nif 'geometry' in merged.columns:\n    gdf = geopandas.GeoDataFrame(merged, geometry='geometry', crs=ref_gdf.crs)\nelse:\n    raise ValueError(\"No se encontr\xf3 columna 'geometry' luego del merge\")\n"})}),"\n",(0,t.jsx)(o.h3,{id:"3-crs-y-smoke-plot",children:"3) CRS y smoke-plot"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:'assert gdf.crs is not None, "CRS ausente: definir o heredar de la capa fuente"\nax = gdf.plot()  # smoke-plot\n'})}),"\n",(0,t.jsx)(o.h3,{id:"4-merge-que-pierde-geometry-patr\xf3n-seguro",children:"4) Merge que pierde geometry (patr\xf3n seguro)"}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{className:"language-python",children:"# preferible: unir atributos tabulares a la capa geo, no al rev\xe9s\nattrs = attrs_df.set_index('CLAVE')\ngdf = ref_gdf.set_index('CLAVE').join(attrs, how='left').reset_index()\ngdf = gdf.set_geometry('geometry')  # por si GeoPandas perdi\xf3 el activo\n"})}),"\n",(0,t.jsx)(o.h2,{id:"pitfalls-comunes",children:"Pitfalls comunes"}),"\n",(0,t.jsxs)(o.ul,{children:["\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.strong,{children:"Aspect ratio \u2264 0"})," al plotear: suele ser ",(0,t.jsx)(o.strong,{children:"geometry NaN"})," o CRS roto."]}),"\n",(0,t.jsxs)(o.li,{children:[(0,t.jsx)(o.code,{children:"merge"})," con ",(0,t.jsx)(o.code,{children:"pandas.DataFrame"})," puede ",(0,t.jsx)(o.strong,{children:"degradar"})," la ",(0,t.jsx)(o.code,{children:"GeoSeries"})," a ",(0,t.jsx)(o.code,{children:"object"}),". Reconstru\xed el ",(0,t.jsx)(o.code,{children:"GeoDataFrame"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(o.blockquote,{children:["\n",(0,t.jsxs)(o.p,{children:["Complementa: ",(0,t.jsx)(o.strong,{children:"/metodos/geo_integration_methods"})," (CRS can\xf3nico, claves y normalizaci\xf3n)."]}),"\n"]}),"\n",(0,t.jsx)(o.pre,{children:(0,t.jsx)(o.code,{children:"(Ref: prechecks de NaN y `set_geometry` tras merges). \x3c!-- removed contentReference --\x3e\n"})})]})}function p(e={}){const{wrapper:o}={...(0,n.R)(),...e.components};return o?(0,t.jsx)(o,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);