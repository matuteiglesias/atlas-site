"use strict";(self.webpackChunkatlas_site=self.webpackChunkatlas_site||[]).push([[5339],{654:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>t,contentTitle:()=>l,default:()=>p,frontMatter:()=>a,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"pocket/pocket_sklearn_compat","title":"Scikit-Learn \u2014 compatibilidad de modelos (pickle/joblib)","description":"Problema","source":"@site/docs/pocket/sklearn_compat.md","sourceDirName":"pocket","slug":"/pocket/sklearn_compat","permalink":"/atlas-site/docs/pocket/sklearn_compat","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/pocket/sklearn_compat.md","tags":[{"inline":true,"label":"sklearn","permalink":"/atlas-site/docs/tags/sklearn"},{"inline":true,"label":"pickle","permalink":"/atlas-site/docs/tags/pickle"},{"inline":true,"label":"joblib","permalink":"/atlas-site/docs/tags/joblib"},{"inline":true,"label":"onnx","permalink":"/atlas-site/docs/tags/onnx"},{"inline":true,"label":"versionado","permalink":"/atlas-site/docs/tags/versionado"},{"inline":true,"label":"mlops","permalink":"/atlas-site/docs/tags/mlops"}],"version":"current","frontMatter":{"id":"pocket_sklearn_compat","title":"Scikit-Learn \u2014 compatibilidad de modelos (pickle/joblib)","slug":"/pocket/sklearn_compat","module":"apendice-pocket","version":"0.1.0","status":"draft","owners":["atlas-core"],"tags":["sklearn","pickle","joblib","onnx","versionado","mlops"],"source_repo":"<repo-url>","source_path":"docs/pocket/sklearn_compat.md"},"sidebar":"tutorialSidebar","previous":{"title":"Selenium/ChromeDriver \u2014 fix r\xe1pidos","permalink":"/atlas-site/docs/pocket/selenium_chromedriver"},"next":{"title":"Inicio \u2014 Atlas de Pobreza","permalink":"/atlas-site/docs/"}}');var r=s(4848),o=s(8453);const a={id:"pocket_sklearn_compat",title:"Scikit-Learn \u2014 compatibilidad de modelos (pickle/joblib)",slug:"/pocket/sklearn_compat",module:"apendice-pocket",version:"0.1.0",status:"draft",owners:["atlas-core"],tags:["sklearn","pickle","joblib","onnx","versionado","mlops"],source_repo:"<repo-url>",source_path:"docs/pocket/sklearn_compat.md"},l=void 0,t={},c=[{value:"Problema",id:"problema",level:2},{value:"Opciones (de menor a mayor fricci\xf3n)",id:"opciones-de-menor-a-mayor-fricci\xf3n",level:2},{value:"Procedimiento recomendado (paso a paso)",id:"procedimiento-recomendado-paso-a-paso",level:2},{value:"Snippets \xfatiles",id:"snippets-\xfatiles",level:2},{value:"Checklist de QA (m\xednimo)",id:"checklist-de-qa-m\xednimo",level:2},{value:"Nota de operaci\xf3n",id:"nota-de-operaci\xf3n",level:2}];function d(e){const n={blockquote:"blockquote",code:"code",em:"em",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h2,{id:"problema",children:"Problema"}),"\n",(0,r.jsxs)(n.p,{children:["Modelos serializados con ",(0,r.jsx)(n.strong,{children:"pickle/joblib"})," pueden ",(0,r.jsx)(n.strong,{children:"no cargar"})," o avisar de riesgos cuando la ",(0,r.jsx)(n.strong,{children:"versi\xf3n de scikit-learn difiere"})," entre quien guard\xf3 y quien lee. Esto afecta reproducibilidad, despliegue y CI/CD."]}),"\n",(0,r.jsx)(n.h2,{id:"opciones-de-menor-a-mayor-fricci\xf3n",children:"Opciones (de menor a mayor fricci\xf3n)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Cargar e ignorar la advertencia"})," si el modelo funciona ",(0,r.jsx)(n.em,{children:"y"})," pasa tests de sanidad. Riesgo: cambios sutiles entre versiones."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Entorno \u201cpinneado\u201d"}),": ",(0,r.jsx)(n.em,{children:"downgrade"})," temporal a la versi\xf3n original \u2192 cargar \u2192 usar."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Re-serializar"})," en el entorno original y documentar dependencias."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Migrar a un formato m\xe1s estable"})," (p.ej., ",(0,r.jsx)(n.strong,{children:"ONNX"}),") cuando el tipo de modelo lo permita."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Re-entrenar"})," en el entorno objetivo y volver a guardar (ideal si ten\xe9s datos/c\xf3digo)."]}),"\n"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Regla pr\xe1ctica: si ",(0,r.jsx)(n.strong,{children:"no vas a re-entrenar"}),", prioriz\xe1 ",(0,r.jsx)(n.em,{children:"entorno pinneado + re-serializaci\xf3n"})," y dej\xe1 huella de versiones."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"procedimiento-recomendado-paso-a-paso",children:"Procedimiento recomendado (paso a paso)"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Identific\xe1 la versi\xf3n fuente"})}),"\n"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Si ten\xe9s metadata, usala; si no, prob\xe1 versiones candidatas."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Replic\xe1 el entorno & carga"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'python -m venv .venv-model && source .venv-model/bin/activate\npip install "scikit-learn==<VERSION_ORIGEN>"\n# opcional: joblib, numpy, scipy en versiones compatibles\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.strong,{children:"Valida y re-serializa"})}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import joblib, platform, sklearn, sys\nmdl = joblib.load("modelo.pkl")         # o pickle.load(...)\njoblib.dump(mdl, "modelo_repacked.joblib")\n\nmeta = {\n  "sklearn": sklearn.__version__,\n  "python": sys.version.split()[0],\n  "platform": platform.platform()\n}\nprint(meta)  # guarda esto junto al artefacto\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Opcional: exportar a ONNX"})," (si aplica)"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'# ejemplo gen\xe9rico; requiere skl2onnx e inferir tipos de entrada\nfrom skl2onnx import to_onnx\nonx = to_onnx(mdl, initial_types=[(\'X\', FloatTensorType([None, n_features]))])\nwith open("modelo.onnx", "wb") as f: f.write(onx.SerializeToString())\n'})}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"No todos los estimadores est\xe1n soportados; verific\xe1 compatibilidad."}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Document\xe1 el entorno"}),"\nGuarda ",(0,r.jsx)(n.code,{children:"requirements.txt"}),", versi\xf3n de sklearn, hash de datos/commit, m\xe9tricas y un ",(0,r.jsx)(n.strong,{children:"model_card.md"})," simple."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"pip freeze > requirements.txt\n"})}),"\n",(0,r.jsx)(n.h2,{id:"snippets-\xfatiles",children:"Snippets \xfatiles"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Downgrade puntual"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'pip install "scikit-learn==1.0.2"\n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Wrapper de carga con guardas"}),":"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'import warnings, joblib\nwith warnings.catch_warnings():\n    warnings.simplefilter("always")  # o "ignore" bajo control de QA\n    mdl = joblib.load("modelo.joblib")\n'})}),"\n",(0,r.jsx)(n.h2,{id:"checklist-de-qa-m\xednimo",children:"Checklist de QA (m\xednimo)"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"predict"}),"/",(0,r.jsx)(n.code,{children:"score"})," reproducen m\xe9tricas de referencia (\xb1 tolerancia)."]}),"\n",(0,r.jsxs)(n.li,{children:["No hay ",(0,r.jsx)(n.em,{children:"feature drift"}),": columnas, orden, ",(0,r.jsx)(n.code,{children:"dtype"})," coinciden con lo esperado."]}),"\n",(0,r.jsxs)(n.li,{children:["Artefactos guardados con: ",(0,r.jsx)(n.strong,{children:"modelo"}),", ",(0,r.jsx)(n.strong,{children:"requirements.txt"}),", ",(0,r.jsx)(n.strong,{children:"metadata.json"})," (versiones, hash, fecha), y ",(0,r.jsx)(n.strong,{children:"model_card.md"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"nota-de-operaci\xf3n",children:"Nota de operaci\xf3n"}),"\n",(0,r.jsx)(n.p,{children:"Para evitar esta clase de incidentes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Pin de versiones"})," (fijar sklearn y dependencias) en entrenamiento e inferencia."]}),"\n",(0,r.jsxs)(n.li,{children:["Serializar con ",(0,r.jsx)(n.strong,{children:"joblib"})," y guardar ",(0,r.jsx)(n.strong,{children:"metadata"})," junto al artefacto."]}),"\n",(0,r.jsxs)(n.li,{children:["Considerar ",(0,r.jsx)(n.strong,{children:"ONNX"})," o ",(0,r.jsx)(n.strong,{children:"pipelines de retraining"})," automatizados cuando el cambio de versi\xf3n sea inevitable."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var i=s(6540);const r={},o=i.createContext(r);function a(e){const n=i.useContext(o);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);